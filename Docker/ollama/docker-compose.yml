networks:
  core_network:
    external: true

volumes:
  webui_data:
  ollama_data:

services:
  ollama:
    image: "ollama/ollama:0.12.5"
    restart: "unless-stopped"
    container_name: "ollama.docker.localhost"
    volumes:
      - "ollama_data:/root/.ollama:rw"
    networks:
      - "core_network"
    ports:
      - "11434:11434/tcp"

  webui:
    image: "ghcr.io/open-webui/open-webui:v0.6.33"
    restart: "unless-stopped"
    container_name: "webui.docker.localhost"
    depends_on:
      - "ollama"
    environment:
      - "OLLAMA_BASE_URL=http://ollama.docker.localhost:11434"
    volumes:
      - "webui_data:/app/backend/data:rw"
    networks:
      - "core_network"
    expose:
      - "8080:8080/tcp"
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.webui.service=webui"
      - "traefik.http.routers.webui.rule=Host(`ollama.docker`)"
      - "traefik.http.services.webui.loadbalancer.server.port=8080"
