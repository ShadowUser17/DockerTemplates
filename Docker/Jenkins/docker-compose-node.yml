version: "3.8"
volumes:
  jenkins_home:
  jenkins_node:

services:
  jenkins:
    container_name: "jenkins-lts"
    image: "jenkins/jenkins:lts-alpine"
    network_mode: "bridge"
    volumes:
      - "jenkins_home:/var/jenkins_home:rw"
    ports:
      - "8080:8080/tcp"
      - "50000:50000/tcp"

  openssh:
    container_name: "node-openssh"
    image: "python:openssh-bullseye"
    network_mode: "bridge"
    build:
      context: "$PWD"
      dockerfile: "dockerfile-python-node"
    depends_on:
      - "jenkins"
    volumes:
      - "jenkins_node:/var/jenkins_node:rw"
    ports:
      - "2222:22/tcp"
