volumes:
  registry_data:

networks:
  core_network:
    external: true

services:
  registry:
    restart: "on-failure"
    image: "registry:2.8.1"
    container_name: "registry.docker.localhost"
    volumes:
      - "registry_data:/var/lib/registry:rw"
      - "$PWD/registry:/etc/docker/registry:ro"
    networks:
      - "core_network"
    ports:
      - "5000:5000/tcp"
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.registry.service=docker-registry"
      - "traefik.http.routers.registry.rule=Host(`registry.docker.localhost`)"
      - "traefik.http.services.docker-registry.loadbalancer.server.port=5000"
