groups:
  - name: "Prometheus self-monitoring"
    rules:
      - alert: "PrometheusJobMissing"
        expr: "absent(up{job=\"prometheus\"})"
        for: "30s"
        labels:
          severity: "warning"
        annotations:
          summary: "Prometheus job missing (instance {{ $labels.instance }})"
          description: "A Prometheus job has disappeared\n  VALUE = {{ $value }}\n  LABELS = {{ $labels }}"
          fingerprint: "Prometheus (Instance: {{ $labels.instance }})"

      - alert: "PrometheusTargetMissing"
        expr: "up == 0"
        for: "30s"
        labels:
          severity: "critical"
        annotations:
          summary: "Prometheus target missing (instance {{ $labels.instance }})"
          description: "A Prometheus target has disappeared. An exporter might be crashed.\n  VALUE = {{ $value }}\n  LABELS = {{ $labels }}"
          fingerprint: "Prometheus (Instance: {{ $labels.instance }})"

  - name: "Prometheus testing"
    rules:
      - alert: TestingWarning
        expr: prometheus_build_info == 1
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "Prometheus testing summary..."
          description: "Prometheus testing description..."
          fingerprint: "Prometheus (Instance: {{ $labels.instance }})"
          dashboard: "-"
          docs: "-"

      - alert: TestingError
        expr: prometheus_build_info == 1
        for: 5m
        labels:
          severity: error
        annotations:
          summary: "Prometheus testing summary..."
          description: "Prometheus testing description..."
          fingerprint: "Prometheus (Instance: {{ $labels.instance }})"
          dashboard: "-"
          docs: "-"

      - alert: TestingCritical
        expr: prometheus_build_info == 1
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: "Prometheus testing summary..."
          description: "Prometheus testing description..."
          fingerprint: "Prometheus (Instance: {{ $labels.instance }})"
          dashboard: "-"
          docs: "-"
